# AUTOGENERATED! DO NOT EDIT! File to edit: ../../notebooks/utils/full-run-utils.ipynb.

# %% auto 0
__all__ = ['select_last_file', 'load_or_create_dataframe']

# %% ../../notebooks/utils/full-run-utils.ipynb 1
import pandas as pd

from pathlib import Path

# %% ../../notebooks/utils/full-run-utils.ipynb 2
def select_last_file(file_path, glob_pattern=r'*[0-9]*.feather'):
    file_path = Path(file_path)
    files = file_path.glob(glob_pattern)
    files = sorted(list(files))
    return files[-1]

def load_or_create_dataframe(save_path, create_function, *args):

    try:
        df = pd.read_feather(save_path)
    except FileNotFoundError:
        df = create_function(*args)
        df.to_feather(save_path)

    return df
